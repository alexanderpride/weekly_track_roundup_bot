# Weekly Track Roundup Bot

This was set-up to collect the songs from theneedledrop's weekly track roundup series into a Spotify playlist. 
The playlist can be found [here](https://open.spotify.com/playlist/5kCKSF7HlIMjlIrStlCCra?si=2ed346f53d7d4586). Whilst it
is currently designed to collect data from the weekly track roundup videos, it can be adapted to collect data from other
youtube videos and add the songs to a spotify playlist.

### Adapting the code

Unfortunately, Spotify doesn't make it easy to set up as they offer no authorisation flow for background processes, so a
workaround is needed. There are 3 files that should be edited if you wish to adapt this code.

#### 1. email_template

This file contains a template that will be used to send an email detailing what was found by the bot. This doesn't have 
to be used, depending on how the configuration file is set up.

#### 2. configuration.py

This file contains the functions and information that is video specific, so will need to be changed to adapt for other 
videos. There are 5 variables and 3 functions that will need to be changed. The variables are described below.

1. ```YOUTUBE_PLAYLIST_ID```: The youtube playlist ID of the playlist you wish to collect new videos from.
2. ```EMAIL_MESSAGE_TEMPLATE```: The name of the file of your email template
3. ```TO_EMAIL_ADDRESS```: The email address the summary will be sent to
4. ```FROM_EMAIL_ADDRESS```: The email address the summary will be sent from
5. ```FREQUENCY```: How frequently the bot will check to see if a new video has been uploaded

The functions are listed below, the comments in each function offer a description of what each function does and how it 
will need to be adjusted.

1. ```get_tracks```: Gets given the videos description and returns a list of the songs in the description
2. ```process_track```: Gets given a track and formats it to something searchable by spotify, each content creator will 
   list the songs differently, so it will need to be adjusted user to user.
3. ```construct_email```: Builds an email to be sent based off of what has been found on Spotify by the bot.

### 3. .env

There is a variety of different variables that will need to be supplied in an .env file for the different APIs and 
libraries used. 

1. ```YOUTUBE_API_KEY```: You will need to create a project in the [Google developers console](https://developers.google.com/)
and enable YouTube Data API v3, and set this variable as the key generated for the API.
2. ```SPOTIPY_USERNAME```: This program uses a library called Spotipy to handle requests to Spotify, your Spotify 
   username.
3. ```SPOTIPY_REDIRECT_URI```: You will need to visit the [Spotify develoepr console](https://developer.spotify.com/dashboard/login)
   and create an app. Under the 'edit settings' option, you will need to create a redirect uri. The redirect uri should 
   be a valid URI format but it should not be to an existing address. It is needed to login to a Spotify account. 
4. ```SPOTIPY_CLIENT_SECRET```: The Spotify client secret for the app
5. ```SPOTIPY_CLIENT_ID```: The Spotify client ID for the app
6. ```SPOTIPY_CACHE```: Due to Spotify not offering a flow that doesn't require redirect authorisation, the cache 
   generated by Spotipy needs to be passed as an environment variable. The spotify_auth_helper.py file can be run which 
   prompts the user to login, and once the login process is complete will print the cache. The cache can then be copy 
   and pasted into the .env file
7. ```PLAYLIST_ID```: The ID of the Spotify playlist you want the collected songs to be added to
8. ```GMAIL_USERNAME```: The username of the gmail account that the email will be sent from, it is recommended that you 
   make a new gmail account for this. You will also need to enable access from less secure locations.
9. ```GMAIL_PASSWORD```: The password for your gmail account